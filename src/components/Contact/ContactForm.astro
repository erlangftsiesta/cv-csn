---
// src/components/Contact/ContactForm.astro
---

<style>
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .form-group {
    animation: fadeIn 0.5s ease-out backwards;
  }

  .form-group:nth-child(1) { animation-delay: 0.1s; }
  .form-group:nth-child(2) { animation-delay: 0.2s; }
  .form-group:nth-child(3) { animation-delay: 0.3s; }
  .form-group:nth-child(4) { animation-delay: 0.4s; }
  .form-group:nth-child(5) { animation-delay: 0.5s; }

  input, textarea, select {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  input:focus, textarea:focus, select:focus {
    border-color: #10b981;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
  }

  textarea {
    resize: vertical;
    min-height: 120px;
  }

  .submit-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgba(16, 185, 129, 0.3);
  }

  .submit-btn:active {
    transform: translateY(0);
  }

  .success-message {
    display: none;
    animation: fadeIn 0.3s ease-out;
  }

  .success-message.show {
    display: block;
  }
</style>

<div>
  <div class="mb-8">
    <h2 class="text-3xl font-bold text-slate-900 mb-3">Kirim Pesan Kepada Kami</h2>
    <p class="text-slate-600">Isi form di bawah dan tim kami akan segera menghubungi Anda</p>
  </div>

  <form id="contact-form" class="space-y-5">
    <!-- Name -->
    <div class="form-group">
      <label for="name" class="block text-sm font-semibold text-slate-900 mb-2">
        Nama Lengkap <span class="text-red-500">*</span>
      </label>
      <input
        type="text"
        id="name"
        name="name"
        required
        placeholder="Masukkan nama Anda"
        class="w-full px-4 py-3 rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      />
    </div>

    <!-- Email -->
    <div class="form-group">
      <label for="email" class="block text-sm font-semibold text-slate-900 mb-2">
        Email <span class="text-red-500">*</span>
      </label>
      <input
        type="email"
        id="email"
        name="email"
        required
        placeholder="email@example.com"
        class="w-full px-4 py-3 rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      />
    </div>

    <!-- Phone -->
    <div class="form-group">
      <label for="phone" class="block text-sm font-semibold text-slate-900 mb-2">
        No. Telepon / WhatsApp <span class="text-red-500">*</span>
      </label>
      <input
        type="tel"
        id="phone"
        name="phone"
        required
        placeholder="0821-xxxx-xxxx"
        class="w-full px-4 py-3 rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      />
    </div>

    <!-- Subject -->
    <div class="form-group">
      <label for="subject" class="block text-sm font-semibold text-slate-900 mb-2">
        Subjek / Kebutuhan <span class="text-red-500">*</span>
      </label>
      <select
        id="subject"
        name="subject"
        required
        class="w-full px-4 py-3 rounded-lg border border-slate-300 bg-white text-slate-900 focus:outline-none"
      >
        <option value="">Pilih Kebutuhan Anda</option>
        <option value="Permintaan Harga">Permintaan Harga</option>
        <option value="Pemesanan Produk">Pemesanan Produk</option>
        <option value="Konsultasi Formulasi">Konsultasi Formulasi</option>
        <option value="Partnership">Partnership / Kerjasama</option>
        <option value="Pertanyaan Umum">Pertanyaan Umum</option>
        <option value="Lainnya">Lainnya</option>
      </select>
    </div>

    <!-- Message -->
    <div class="form-group">
      <label for="message" class="block text-sm font-semibold text-slate-900 mb-2">
        Pesan <span class="text-red-500">*</span>
      </label>
      <textarea
        id="message"
        name="message"
        required
        placeholder="Tuliskan pesan atau pertanyaan Anda di sini..."
        class="w-full px-4 py-3 rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      ></textarea>
    </div>

    <!-- Checkbox -->
    <div class="form-group">
      <label class="flex items-center gap-3 cursor-pointer">
        <input
          type="checkbox"
          id="agree"
          name="agree"
          required
          class="w-5 h-5 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500 accent-emerald-600"
        />
        <span class="text-sm text-slate-600">
          Saya setuju untuk dihubungi oleh tim CSN melalui email atau telepon
        </span>
      </label>
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      class="submit-btn w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-bold py-4 px-6 rounded-lg shadow-lg"
    >
      <span id="submit-text">Kirim Pesan →</span>
      <span id="submit-loading" style="display: none;">Mengirim...</span>
    </button>

    <!-- Success Message -->
    <div id="success-message" class="success-message bg-green-50 border border-green-200 text-green-800 px-4 py-4 rounded-lg">
      <div class="flex items-start gap-3">
        <span class="text-2xl">✅</span>
        <div>
          <p class="font-semibold">Pesan Terkirim!</p>
          <p class="text-sm text-green-700 mt-1">Terima kasih telah menghubungi kami. Tim kami akan segera merespons.</p>
        </div>
      </div>
    </div>

    <!-- Error Message -->
    <div id="error-message" class="hidden bg-red-50 border border-red-200 text-red-800 px-4 py-4 rounded-lg">
      <div class="flex items-start gap-3">
        <span class="text-2xl">❌</span>
        <div>
          <p class="font-semibold">Terjadi Kesalahan</p>
          <p id="error-text" class="text-sm text-red-700 mt-1">Silakan coba lagi</p>
        </div>
      </div>
    </div>
  </form>
</div>

<script>
  function initContactForm() {
    const form = document.getElementById('contact-form') as HTMLFormElement | null;
    const submitBtn = form?.querySelector('button[type="submit"]') as HTMLButtonElement | null;
    const submitText = document.getElementById('submit-text') as HTMLSpanElement | null;
    const submitLoading = document.getElementById('submit-loading') as HTMLSpanElement | null;
    const successMsg = document.getElementById('success-message') as HTMLDivElement | null;
    const errorMsg = document.getElementById('error-message') as HTMLDivElement | null;
    const errorText = document.getElementById('error-text') as HTMLParagraphElement | null;

    if (!form || !submitBtn || !submitText || !submitLoading || !successMsg || !errorMsg || !errorText) {
      console.warn('Contact form elements not found');
      return;
    }

    form.addEventListener('submit', async (e: Event) => {
      e.preventDefault();

      // Show loading state
      submitBtn.disabled = true;
      submitText.style.display = 'none';
      submitLoading.style.display = 'inline';
      errorMsg.classList.add('hidden');

      try {
        // Simulate successful submission
        await new Promise(resolve => setTimeout(resolve, 1500));

        // Show success message
        successMsg.classList.add('show');
        form.reset();

        // Hide success message after 5 seconds
        setTimeout(() => {
          successMsg.classList.remove('show');
        }, 5000);

      } catch (error) {
        errorText.textContent = 'Gagal mengirim pesan. Silakan coba lagi.';
        errorMsg.classList.remove('hidden');
      } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitText.style.display = 'inline';
        submitLoading.style.display = 'none';
      }
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initContactForm);
  } else {
    initContactForm();
  }
</script>