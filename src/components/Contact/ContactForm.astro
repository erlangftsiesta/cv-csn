---
// src/components/Contact/ContactForm.astro
---

<style>
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .form-group {
    animation: fadeIn 0.5s ease-out backwards;
  }

  .form-group:nth-child(1) { animation-delay: 0.1s; }
  .form-group:nth-child(2) { animation-delay: 0.2s; }
  .form-group:nth-child(3) { animation-delay: 0.3s; }
  .form-group:nth-child(4) { animation-delay: 0.4s; }
  .form-group:nth-child(5) { animation-delay: 0.5s; }

  input, textarea, select {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  input:focus, textarea:focus, select:focus {
    border-color: #10b981;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
  }

  textarea {
    resize: vertical;
    min-height: 120px;
  }

  .submit-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 24px rgba(16, 185, 129, 0.3);
  }

  .submit-btn:active {
    transform: translateY(0);
  }
</style>

<div>
  <div class="mb-6 md:mb-8">
    <h2 class="text-2xl md:text-3xl font-bold text-slate-900 mb-2 md:mb-3">Kirim Pesan Kepada Kami</h2>
    <p class="text-sm md:text-base text-slate-600">Isi form di bawah dan Anda akan diarahkan ke WhatsApp kami</p>
  </div>

  <form id="contact-form" class="space-y-4 md:space-y-5">
    <!-- Name -->
    <div class="form-group">
      <label for="name" class="block text-xs md:text-sm font-semibold text-slate-900 mb-1.5 md:mb-2">
        Nama Lengkap <span class="text-red-500">*</span>
      </label>
      <input
        type="text"
        id="name"
        name="name"
        required
        placeholder="Masukkan nama Anda"
        class="w-full px-3 md:px-4 py-2.5 md:py-3 text-sm md:text-base rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      />
    </div>

    <!-- Email -->
    <div class="form-group">
      <label for="email" class="block text-xs md:text-sm font-semibold text-slate-900 mb-1.5 md:mb-2">
        Email <span class="text-red-500">*</span>
      </label>
      <input
        type="email"
        id="email"
        name="email"
        required
        placeholder="email@example.com"
        class="w-full px-3 md:px-4 py-2.5 md:py-3 text-sm md:text-base rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      />
    </div>

    <!-- Phone -->
    <div class="form-group">
      <label for="phone" class="block text-xs md:text-sm font-semibold text-slate-900 mb-1.5 md:mb-2">
        No. Telepon / WhatsApp <span class="text-red-500">*</span>
      </label>
      <input
        type="tel"
        id="phone"
        name="phone"
        required
        placeholder="0821-xxxx-xxxx"
        class="w-full px-3 md:px-4 py-2.5 md:py-3 text-sm md:text-base rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      />
    </div>

    <!-- Subject -->
    <div class="form-group">
      <label for="subject" class="block text-xs md:text-sm font-semibold text-slate-900 mb-1.5 md:mb-2">
        Subjek / Kebutuhan <span class="text-red-500">*</span>
      </label>
      <select
        id="subject"
        name="subject"
        required
        class="w-full px-3 md:px-4 py-2.5 md:py-3 text-sm md:text-base rounded-lg border border-slate-300 bg-white text-slate-900 focus:outline-none"
      >
        <option value="">Pilih Kebutuhan Anda</option>
        <option value="Permintaan Harga">Permintaan Harga</option>
        <option value="Pemesanan Produk">Pemesanan Produk</option>
        <option value="Konsultasi Formulasi">Konsultasi Formulasi</option>
        <option value="Partnership">Partnership / Kerjasama</option>
        <option value="Pertanyaan Umum">Pertanyaan Umum</option>
        <option value="Lainnya">Lainnya</option>
      </select>
    </div>

    <!-- Message -->
    <div class="form-group">
      <label for="message" class="block text-xs md:text-sm font-semibold text-slate-900 mb-1.5 md:mb-2">
        Pesan <span class="text-red-500">*</span>
      </label>
      <textarea
        id="message"
        name="message"
        required
        placeholder="Tuliskan pesan atau pertanyaan Anda di sini..."
        class="w-full px-3 md:px-4 py-2.5 md:py-3 text-sm md:text-base rounded-lg border border-slate-300 bg-white text-slate-900 placeholder-slate-400 focus:outline-none"
      ></textarea>
    </div>

    <!-- Checkbox -->
    <div class="form-group">
      <label class="flex items-start md:items-center gap-2 md:gap-3 cursor-pointer">
        <input
          type="checkbox"
          id="agree"
          name="agree"
          required
          class="w-4 h-4 md:w-5 md:h-5 mt-0.5 md:mt-0 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500 accent-emerald-600 flex-shrink-0"
        />
        <span class="text-xs md:text-sm text-slate-600">
          Saya setuju untuk dihubungi oleh tim CSN melalui email atau telepon
        </span>
      </label>
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      class="submit-btn w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-bold py-3 md:py-4 px-4 md:px-6 rounded-lg shadow-lg text-sm md:text-base"
    >
      <span id="submit-text">Kirim via WhatsApp â†’</span>
      <span id="submit-loading" style="display: none;">Memproses...</span>
    </button>

    <p class="text-xs text-slate-500 text-center">
      Anda akan diarahkan ke WhatsApp untuk melanjutkan percakapan
    </p>
  </form>
</div>

<script>
  // WhatsApp number (format: country code + number without + or spaces)
  const WHATSAPP_NUMBER = '6281234567890'; // Ganti dengan nomor WA bisnis Anda

  function initContactForm() {
    const form = document.getElementById('contact-form') as HTMLFormElement | null;
    const submitBtn = form?.querySelector('button[type="submit"]') as HTMLButtonElement | null;
    const submitText = document.getElementById('submit-text') as HTMLSpanElement | null;
    const submitLoading = document.getElementById('submit-loading') as HTMLSpanElement | null;

    if (!form || !submitBtn || !submitText || !submitLoading) {
      console.warn('Contact form elements not found');
      return;
    }

    form.addEventListener('submit', (e: Event) => {
      e.preventDefault();

      // Show loading state
      submitBtn.disabled = true;
      submitText.style.display = 'none';
      submitLoading.style.display = 'inline';

      // Get form data
      const formData = new FormData(form);
      const name = formData.get('name') as string;
      const email = formData.get('email') as string;
      const phone = formData.get('phone') as string;
      const subject = formData.get('subject') as string;
      const message = formData.get('message') as string;

      // Build WhatsApp message
      const whatsappMessage = `Halo, saya ingin bertanya lebih lanjut.

 *Informasi Kontak*
Nama: ${name}
Email: ${email}
No. Telepon: ${phone}

 *Subjek*
${subject}

 *Pesan*
${message}

Terima kasih!`;

      // Encode message for URL
      const encodedMessage = encodeURIComponent(whatsappMessage);
      
      // Create WhatsApp URL
      const whatsappURL = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`;

      // Redirect to WhatsApp
      setTimeout(() => {
        window.open(whatsappURL, '_blank');
        
        // Reset form and button
        form.reset();
        submitBtn.disabled = false;
        submitText.style.display = 'inline';
        submitLoading.style.display = 'none';
      }, 500);
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initContactForm);
  } else {
    initContactForm();
  }
</script>